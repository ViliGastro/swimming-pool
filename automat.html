<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ƒåejs 27 ‚Äì Nov√© symboly + jemn√Ω 3D efekt</title>
  <style>
    /* Z√ÅKLADN√â POZADIE A P√çSMO */
    body {
      margin: 0;
      padding: 0;
      background: url('background.jpg') no-repeat center center fixed;
      background-size: cover;
      font-family: Arial, sans-serif;
      color: #fff;
      text-align: center;
    }

    /* HLAVN√ù OBAL */
    .container {
      width: 900px;
      margin: 40px auto;
      padding: 20px;
      background: rgba(0, 0, 0, 0.8);
      border-radius: 15px;
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.8);
      position: relative;
    }

    /* NADPIS */
    h1 {
      color: #FFD700;
      font-size: 3em;
      text-shadow:
        0 0 10px #FFD700,
        0 0 20px #FFA500,
        0 0 30px #FF8C00;
      margin-bottom: 20px;
    }

    /* SLOT MACHINE LAYOUT s perspekt√≠vou pre 3D efekt */
    .slot-machine {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 5px; 
      justify-content: center;
      margin: 20px 0;
      perspective: 800px; /* Jemn√° perspekt√≠va */
    }

    /* Ka≈æd√Ω valec */
    .reel {
      width: 200px;
      height: 600px; 
      overflow: hidden;
      background-color: #111;
      border: 3px solid #333;
      border-radius: 10px;
      box-shadow: inset 0 0 15px black;
      position: relative;
      /* Umo≈æn√≠ vn√∫torn√Ωm prvkom toƒçi≈• sa v 3D */
      transform-style: preserve-3d;
    }

    .symbols {
      position: absolute;
      top: 0;
      width: 100%;
      display: flex;
      flex-direction: column;
      /* Pre istotu deklarujeme aj transform-origin */
      transform-origin: center center;
    }

    /* Ka≈æd√Ω symbol 200√ó200 */
    .symbol {
      width: 100%;
      height: 200px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 80px;
      color: white;
      text-shadow: 0 0 10px black;
      transition: background-color 0.3s;
    }

    /* Wild s minimalistick√Ωm fontom + r√°mƒçekom */
    .wildSymbol {
      font-family: "Arial", sans-serif;
      color: #00FFFF;
      font-weight: bold;
      border: 2px solid #fff;
      border-radius: 6px;
      padding: 4px 8px;
    }

    /* Zv√Ωraznenie v√Ωhern√Ωch symbolov */
    .symbol.highlight {
      background-color: rgba(255, 255, 0, 0.3);
    }

    /* TLAƒåIDL√Å */
    .controls {
      margin-top: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
    }

    button {
      font-weight: bold;
      color: #fff;
      background-color: #ffb300;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: 0.3s;
      box-shadow: 0 0 10px rgba(255, 179, 0, 0.7);
    }
    button:hover {
      background-color: #ff8400;
      box-shadow: 0 0 15px rgba(255, 132, 0, 0.9);
    }

    .bet-button {
      font-size: 20px;
      padding: 10px 20px;
    }
    .spin-button {
      font-size: 36px;
      padding: 20px 60px;
    }

    .result {
      font-size: 24px;
      margin: 10px 0;
      text-shadow: 0 0 5px #fff;
    }

    /* INFO-BAR DOLE (kredity vƒæavo, st√°vka vpravo) */
    .info-bar {
      position: absolute;
      bottom: 20px;
      left: 20px;
      right: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 24px;
    }
    .credits, .bet {
      text-shadow: 0 0 5px #fff;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ƒåejs 27</h1>

    <!-- Tu bude slot machine -->
    <div class="slot-machine">
      <div class="reel" id="reel1">
        <div class="symbols"></div>
      </div>
      <div class="reel" id="reel2">
        <div class="symbols"></div>
      </div>
      <div class="reel" id="reel3">
        <div class="symbols"></div>
      </div>
    </div>

    <!-- Ovl√°dacie prvky -->
    <div class="controls">
      <button class="bet-button" onclick="decreaseBet()">-</button>
      <button class="spin-button" onclick="spin()">TOƒåI≈§</button>
      <button class="bet-button" onclick="increaseBet()">+</button>
    </div>

    <!-- V√Ωsledn√° hl√°≈°ka o v√Ωhre / prehre -->
    <div class="result" id="result">
      Roztoƒçte valce a sk√∫ste ≈°≈•astie!
    </div>

    <!-- Info bar vƒæavo dole a vpravo dole -->
    <div class="info-bar">
      <div class="credits" id="credits">Kredit: 200</div>
      <div class="bet">St√°vka: <span id="betAmount">10</span></div>
    </div>
  </div>

  <script>
    const reels = document.querySelectorAll('.reel');
    const creditsDisplay = document.getElementById('credits');
    const betAmountDisplay = document.getElementById('betAmount');
    const resultDisplay = document.getElementById('result');

    // Zaƒçiatoƒçn√Ω kredit
    let credits = 200;
    let betAmount = 10;

    // Pridali sme dve nov√© symboly: "üî•" a "üí∞"
    // Celkov√Ω zoznam:
    const allSymbols = ["üçí", "üçã", "üçá", "üçâ", "‚≠ê", "Wild", "üî•", "üí∞"];

    // Pri naƒç√≠tan√≠ str√°nky vygenerujeme 12 symbolov pre ka≈æd√Ω valec
    window.onload = () => {
      reels.forEach((reel) => {
        generate12Symbols(reel);
      });
    };

    /**
     * Vygeneruje 12 symbolov do dan√©ho valca.
     */
    function generate12Symbols(reel) {
      const container = reel.querySelector('.symbols');
      container.innerHTML = "";
      for (let i = 0; i < 12; i++) {
        const sym = createRandomSymbolDiv();
        container.appendChild(sym);
      }
    }

    /**
     * Vytvor√≠ <div class="symbol"> s n√°hodn√Ωm symbolom.
     * Ak je symbol "Wild", pou≈æije ≈°peci√°lnu .wildSymbol.
     */
    function createRandomSymbolDiv() {
      const randomSymbol = allSymbols[Math.floor(Math.random() * allSymbols.length)];
      const div = document.createElement('div');
      div.classList.add('symbol');

      if (randomSymbol === "Wild") {
        div.innerHTML = `<span class="wildSymbol">WILD</span>`;
      } else {
        div.textContent = randomSymbol;
      }
      return div;
    }

    /**
     * Priprav√≠ valec na nov√© zatoƒçenie:
     *  - vezme posledn√© 3 symboly (indexy 9..11) a presunie ich na zaƒçiatok
     *  - zvy≈°n√Ωch 9 symbolov vyma≈æe
     *  - vygeneruje 9 nov√Ωch symbolov
     */
    function prepareReelForSpin(reel) {
      const container = reel.querySelector('.symbols');
      const oldSymbols = Array.from(container.querySelectorAll('.symbol'));

      // Indexy 9,10,11 s√∫ tie spodn√© 3 symboly z predo≈°l√©ho spinu
      const final3 = oldSymbols.slice(9, 12);

      // Vyma≈æeme v≈°etko
      container.innerHTML = "";

      // Najprv prid√°me final3 (aktu√°lne "navrchu" pre nov√© toƒçenie)
      final3.forEach(sym => container.appendChild(sym));

      // Potom vygenerujeme 9 nov√Ωch
      for (let i = 0; i < 9; i++) {
        const newSym = createRandomSymbolDiv();
        container.appendChild(newSym);
      }
    }

    function spin() {
      if (credits < betAmount) {
        resultDisplay.textContent = 'Nem√°te dostatok kreditov!';
        resultDisplay.style.color = 'red';
        return;
      }

      credits -= betAmount;
      creditsDisplay.textContent = `Kredit: ${credits}`;
      resultDisplay.textContent = 'Valce sa toƒçia...';
      resultDisplay.style.color = 'white';

      // Odstr√°nime zv√Ωraznenie star√Ωch v√Ωhier
      removeAllHighlights();

      // Ka≈æd√Ω valec priprav√≠me na nov√Ω spin
      reels.forEach((reel) => {
        prepareReelForSpin(reel);
      });

      // Spust√≠me anim√°ciu
      let completed = 0;
      reels.forEach((reel) => {
        spinReelAnimation(reel, () => {
          completed++;
          if (completed === reels.length) {
            checkWin();
          }
        });
      });
    }

    /**
     * Anim√°cia toƒçenia (3 sekundy).
     * Posun: 0 -> -2400 px (12 symbolov √ó 200px).
     * Okrem translateY prid√°me aj jemn√© rotateX na vytvorenie 3D efektu.
     */
    function spinReelAnimation(reel, onComplete) {
      const symbolsContainer = reel.querySelector('.symbols');
      const startTime = performance.now();
      const duration = 3000;
      const maxOffset = 2400;

      function animate(time) {
        let elapsed = time - startTime;
        if (elapsed > duration) elapsed = duration;

        const progress = elapsed / duration;
        const eased = easeInOutQuad(progress);

        // Nastav√≠me pohyb zhora nadol
        const currentOffset = -maxOffset * eased;

        // Jemn√© naklonenie, napr. max 10¬∞ okolo stredu
        // ƒå√≠m bli≈æ≈°ie k 0.5, t√Ωm v√§ƒç≈°√≠ uhol
        const tiltAngle = 10 * (0.5 - Math.abs(progress - 0.5));

        // Aplikujeme oboje
        symbolsContainer.style.transform = `
          translateY(${currentOffset}px)
          rotateX(${tiltAngle}deg)
        `;

        if (elapsed < duration) {
          requestAnimationFrame(animate);
        } else {
          symbolsContainer.style.transform = `translateY(${-maxOffset}px) rotateX(0deg)`;
          onComplete && onComplete();
        }
      }
      requestAnimationFrame(animate);
    }

    // Zr√Ωchlenie/spomalenie
    function easeInOutQuad(t) {
      return t < 0.5
        ? 2 * t * t
        : 1 - Math.pow(-2 * t + 2, 2) / 2;
    }

    /**
     * Po skonƒçen√≠ toƒçenia s√∫ "viditeƒæn√©" indexy 9..11 (spodn√© 3).
     * Vyhodnocujeme 3 horizont√°lne l√≠nie + 2 diagon√°ly.
     */
    function checkWin() {
      const reelSymbols = [];
      reels.forEach((reel) => {
        const syms = reel.querySelectorAll('.symbol');
        reelSymbols.push([
          syms[9],
          syms[10],
          syms[11],
        ]);
      });

      let totalMultiplier = 0;

      // 3 horizont√°lne l√≠nie (row 0..2)
      for (let row = 0; row < 3; row++) {
        const s1 = reelSymbols[0][row];
        const s2 = reelSymbols[1][row];
        const s3 = reelSymbols[2][row];
        totalMultiplier += checkLineAndGetMultiplier(s1, s2, s3);
      }

      // Diagon√°la 1 (zƒæava hore -> doprava dole)
      {
        const s1 = reelSymbols[0][0];
        const s2 = reelSymbols[1][1];
        const s3 = reelSymbols[2][2];
        totalMultiplier += checkLineAndGetMultiplier(s1, s2, s3);
      }
      // Diagon√°la 2 (zƒæava dole -> doprava hore)
      {
        const s1 = reelSymbols[0][2];
        const s2 = reelSymbols[1][1];
        const s3 = reelSymbols[2][0];
        totalMultiplier += checkLineAndGetMultiplier(s1, s2, s3);
      }

      if (totalMultiplier > 0) {
        const winAmount = betAmount * totalMultiplier;
        credits += winAmount;
        creditsDisplay.textContent = `Kredit: ${credits}`;
        resultDisplay.textContent = `Vyhrali ste ${winAmount} kreditov!`;
        resultDisplay.style.color = 'lime';
      } else {
        resultDisplay.textContent = `≈Ωiadna v√Ωhra, sk√∫ste to znova.`;
        resultDisplay.style.color = 'red';
      }
    }

    /**
     * Ak s√∫ symboly rovnak√© alebo Wild (≈æol√≠k), z√°klad je 2√ó st√°vka,
     * ka≈æd√Ω Wild navy≈°uje √ó2. Zv√Ωrazn√≠ v√≠≈•azn√© symboly.
     */
    function checkLineAndGetMultiplier(el1, el2, el3) {
      const s1 = getSymbolText(el1);
      const s2 = getSymbolText(el2);
      const s3 = getSymbolText(el3);

      const distinctNonWild = new Set(
        [s1, s2, s3].filter(sym => sym !== 'Wild')
      );

      if (distinctNonWild.size <= 1) {
        let rowMultiplier = 2;
        const wildCount = [s1, s2, s3].filter(x => x === 'Wild').length;
        rowMultiplier *= Math.pow(2, wildCount);

        el1.classList.add('highlight');
        el2.classList.add('highlight');
        el3.classList.add('highlight');
        return rowMultiplier;
      }
      return 0;
    }

    /**
     * getSymbolText(el): ak je <span class="wildSymbol">WILD</span>, vr√°time "Wild",
     * inak vr√°time text (napr. "üçí" alebo "üî•").
     */
    function getSymbolText(el) {
      const span = el.querySelector('.wildSymbol');
      if (span) return 'Wild';
      return el.textContent.trim();
    }

    /** Odstr√°ni zv√Ωraznenie v≈°etk√Ωch symbolov. */
    function removeAllHighlights() {
      reels.forEach((reel) => {
        reel.querySelectorAll('.symbol').forEach(sym => {
          sym.classList.remove('highlight');
        });
      });
    }

    // Zv√Ω≈°enie / Zn√≠≈æenie st√°vky
    function increaseBet() {
      betAmount += 10;
      betAmountDisplay.textContent = betAmount;
    }

    function decreaseBet() {
      if (betAmount > 10) {
        betAmount -= 10;
        betAmountDisplay.textContent = betAmount;
      }
    }
  </script>
</body>
</html>
