<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ƒåejs 27 ‚Äì Men≈°ie valce, okr√∫hle tlaƒçidl√°, autostart</title>
  <style>
    /* ---------- Z√ÅKLADN√â NASTAVENIA ---------- */
    body {
      margin: 0;
      padding: 0;
      background: url('background.jpg') no-repeat center center fixed;
      background-size: cover;
      font-family: Arial, sans-serif;
      color: #fff;
      text-align: center;
    }

    .container {
      width: 900px;
      margin: 40px auto;
      padding: 20px;
      background: rgba(0, 0, 0, 0.8);
      border-radius: 15px;
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.8);
      position: relative;
    }

    h1 {
      color: #FFD700;
      font-size: 3em;
      text-shadow:
        0 0 10px #FFD700,
        0 0 20px #FFA500,
        0 0 30px #FF8C00;
      margin-bottom: 20px;
    }

    /* ---------- MEN≈†IE VALCE (POLovica) ---------- */
    .slot-machine {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 5px;
      justify-content: center;
      margin: 20px 0;
    }

    .reel {
      width: 100px;   /* poloviƒçn√° ≈°√≠rka (boli 200) */
      height: 300px;  /* poloviƒçn√° v√Ω≈°ka (bolo 600) */
      overflow: hidden;
      background-color: #111;
      border: 3px solid #333;
      border-radius: 10px;
      box-shadow: inset 0 0 15px black;
      position: relative;
    }

    .symbols {
      position: absolute;
      top: 0;
      width: 100%;
      display: flex;
      flex-direction: column;
    }

    /* Symboly - poloviƒçn√° v√Ω≈°ka (bolo 200 px => 100 px) */
    .symbol {
      width: 100%;
      height: 100px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 40px; /* zmen≈°en√© font-size (bolo 80) */
      color: white;
      text-shadow: 0 0 10px black;
      transition: background-color 0.3s;
    }

    /* Wild = in√Ω text, napr. "JOKER" */
    .wildSymbol {
      font-family: "Brush Script MT", cursive;
      color: #FF69B4;
      text-shadow:
        0 0 5px #ff69b4,
        0 0 10px #ff1493;
      font-weight: bold;
    }

    .symbol.highlight {
      background-color: rgba(255, 255, 0, 0.3);
    }

    /* ---------- TLAƒåIDL√Å ---------- */
    .controls {
      margin-top: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
    }

    /* Okr√∫hle tlaƒçidl√° st√°vky */
    .bet-button {
      font-size: 18px;
      font-weight: bold;
      color: #fff;
      background-color: #ffb300;
      border: none;
      border-radius: 50%;   /* okr√∫hle */
      cursor: pointer;
      width: 50px; 
      height: 50px;         /* rovnako ≈°√≠rka aj v√Ω≈°ka */
      box-shadow: 0 0 10px rgba(255, 179, 0, 0.7);
      transition: 0.3s;
    }
    .bet-button:hover {
      background-color: #ff8400;
      box-shadow: 0 0 15px rgba(255, 132, 0, 0.9);
    }

    /* Tlaƒçidlo TOƒåI≈§ = 2√ó v√§ƒç≈°ie ako predt√Ωm */
    .spin-button {
      font-size: 48px;         /* dvakr√°t v√§ƒç≈°ie ako p√¥vodn√Ωch ~24 */
      padding: 20px 50px;
      font-weight: bold;
      color: #fff;
      background-color: #ffb300;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      box-shadow: 0 0 10px rgba(255, 179, 0, 0.7);
      transition: 0.3s;
    }
    .spin-button:hover {
      background-color: #ff8400;
      box-shadow: 0 0 15px rgba(255, 132, 0, 0.9);
    }

    /* Nov√© tlaƒçidlo AUTO */
    .auto-button {
      font-size: 24px;
      padding: 14px 25px;
      color: #fff;
      background-color: #999;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      box-shadow: 0 0 10px rgba(150, 150, 150, 0.5);
      transition: 0.3s;
    }
    .auto-button:hover {
      background-color: #666;
      box-shadow: 0 0 15px rgba(100, 100, 100, 0.9);
    }
    .auto-button.active {
      background-color: #00cc66; /* zelenkav√© pre aktivovan√Ω stav */
      box-shadow: 0 0 15px #00cc66;
    }

    /* ---------- INFO DOLE (KREDIT DOƒΩAVA, V√ùHRA DOPRAVA) ---------- */
    .bottom-info {
      position: relative;
      margin-top: 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    /* Kredit dole vƒæavo v ƒçiernom tenkom r√°miku */
    .credits-box {
      border: 1px solid #000;
      background-color: rgba(0,0,0,0.3);
      padding: 5px 10px;
      border-radius: 5px;
      font-size: 20px;
    }

    /* V√Ωhra (resp. stav) dole vpravo v ƒçiernom tenkom r√°miku */
    .result-box {
      border: 1px solid #000;
      background-color: rgba(0,0,0,0.3);
      padding: 5px 10px;
      border-radius: 5px;
      font-size: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ƒåejs 27</h1>

    <!-- Slot machine (men≈°ie valce) -->
    <div class="slot-machine">
      <div class="reel" id="reel1">
        <div class="symbols"></div>
      </div>
      <div class="reel" id="reel2">
        <div class="symbols"></div>
      </div>
      <div class="reel" id="reel3">
        <div class="symbols"></div>
      </div>
    </div>

    <!-- Ovl√°dacie tlaƒçidl√° -->
    <div class="controls">
      <button class="bet-button" onclick="decreaseBet()">-</button>
      <button class="spin-button" onclick="spin()">TOƒåI≈§</button>
      <button class="auto-button" id="autoBtn" onclick="toggleAutospin()">AUTO</button>
      <button class="bet-button" onclick="increaseBet()">+</button>
    </div>

    <!-- Spodn√Ω panel s kreditom vƒæavo a v√Ωsledkom vpravo -->
    <div class="bottom-info">
      <div class="credits-box" id="creditsBox">Kredit: 200</div>
      <div class="result-box" id="resultBox">Pripraven√Ω...</div>
    </div>
  </div>

  <script>
    const reels = document.querySelectorAll('.reel');
    const creditsBox = document.getElementById('creditsBox');
    const resultBox = document.getElementById('resultBox');
    const betAmountDisplay = document.createElement('span'); 
    let credits = 200;
    let betAmount = 10;

    // Symboly (vr√°tane "Wild" -> text: "JOKER")
    const allSymbols = ["üçí", "üçã", "üçá", "üçâ", "‚≠ê", "Wild"];

    // AUTOSPIN
    let autoSpin = false;  // keƒè je true, hneƒè po vyhodnoten√≠ spin znovu

    // Pri naƒç√≠tan√≠ str√°nky vygenerujeme 9 symbolov na ka≈æd√Ω valec
    window.onload = () => {
      reels.forEach((reel) => {
        generate9Symbols(reel);
      });
      updateDisplays();
    };

    function generate9Symbols(reel) {
      const container = reel.querySelector('.symbols');
      container.innerHTML = "";
      for (let i = 0; i < 9; i++) {
        container.appendChild(createRandomSymbolDiv());
      }
    }

    function createRandomSymbolDiv() {
      const randomSymbol = allSymbols[Math.floor(Math.random() * allSymbols.length)];
      const div = document.createElement('div');
      div.classList.add('symbol');

      if (randomSymbol === "Wild") {
        // In√Ω text: "JOKER"
        div.innerHTML = `<span class="wildSymbol">JOKER</span>`;
      } else {
        div.textContent = randomSymbol;
      }
      return div;
    }

    function prepareReelForSpin(reel) {
      const container = reel.querySelector('.symbols');
      const oldSymbols = Array.from(container.querySelectorAll('.symbol'));
      const final3 = oldSymbols.slice(6, 9); 
      container.innerHTML = "";
      // Zachov√°me posledn√© 3, potom vygenerujeme 6 nov√Ωch
      final3.forEach(sym => container.appendChild(sym));
      for (let i = 0; i < 6; i++) {
        container.appendChild(createRandomSymbolDiv());
      }
    }

    function spin() {
      if (credits < betAmount) {
        resultBox.textContent = 'Nem√°te dos≈• kreditov!';
        resultBox.style.color = 'red';
        autoSpin = false;  // vypneme autospin, ak do≈°li kredity
        document.getElementById('autoBtn').classList.remove('active');
        return;
      }

      // Odpoƒç√≠tame st√°vku
      credits -= betAmount;
      updateDisplays();
      resultBox.textContent = 'Valce sa toƒçia...';
      resultBox.style.color = 'white';

      removeAllHighlights();
      reels.forEach((reel) => {
        prepareReelForSpin(reel);
      });

      let completed = 0;
      reels.forEach((reel) => {
        spinReelAnimation(reel, () => {
          completed++;
          if (completed === reels.length) {
            checkWin();
          }
        });
      });
    }

    function spinReelAnimation(reel, onComplete) {
      const symbolsContainer = reel.querySelector('.symbols');
      const startTime = performance.now();
      const duration = 3000; 
      const maxOffset = 600;  // poloviƒçn√© valce -> 3 symboly * 100px = 300; ALE generujeme 6 (300*2)? 
                             // P√¥vodne bolo 1200 pri 200px. Tak pri poloviƒçnej veƒækosti m√¥≈æeme da≈• 600.
      function animate(time) {
        let elapsed = time - startTime;
        if (elapsed > duration) elapsed = duration;

        const progress = elapsed / duration;
        const eased = easeInOutQuad(progress);
        const currentOffset = -maxOffset * eased;
        symbolsContainer.style.transform = `translateY(${currentOffset}px)`;

        if (elapsed < duration) {
          requestAnimationFrame(animate);
        } else {
          symbolsContainer.style.transform = `translateY(${-maxOffset}px)`;
          onComplete && onComplete();
        }
      }
      requestAnimationFrame(animate);
    }

    function easeInOutQuad(t) {
      return (t < 0.5) ? 2*t*t : 1 - Math.pow(-2*t + 2, 2)/2;
    }

    function checkWin() {
      // Po skonƒçen√≠ anim√°cie s√∫ zobrazen√© poz√≠cie 6..8
      const reelSymbols = [];
      reels.forEach((reel) => {
        const syms = reel.querySelectorAll('.symbol');
        reelSymbols.push([
          syms[6],
          syms[7],
          syms[8],
        ]);
      });

      let totalMultiplier = 0;

      // Horizont√°lne (3 riadky)
      for (let row = 0; row < 3; row++) {
        totalMultiplier += checkLine(reelSymbols[0][row], reelSymbols[1][row], reelSymbols[2][row]);
      }

      // Diagon√°la 1
      totalMultiplier += checkLine(reelSymbols[0][0], reelSymbols[1][1], reelSymbols[2][2]);
      // Diagon√°la 2
      totalMultiplier += checkLine(reelSymbols[0][2], reelSymbols[1][1], reelSymbols[2][0]);

      if (totalMultiplier > 0) {
        const winAmount = betAmount * totalMultiplier;
        credits += winAmount;
        updateDisplays();
        resultBox.textContent = `Vyhrali ste ${winAmount} kreditov!`;
        resultBox.style.color = 'lime';
      } else {
        resultBox.textContent = `≈Ωiadna v√Ωhra, sk√∫ste to znova.`;
        resultBox.style.color = 'red';
      }

      // Ak je autospin zapnut√Ω a m√°me dos≈• kreditov, spust√≠me znovu
      if (autoSpin && credits >= betAmount) {
        // Kr√°tka pauza, aby bolo vidno v√Ωsledok
        setTimeout(() => {
          spin();
        }, 700);
      } else {
        // Vypneme autospin, ak u≈æ nie s√∫ kredity
        if (credits < betAmount) {
          autoSpin = false;
          document.getElementById('autoBtn').classList.remove('active');
        }
      }
    }

    function checkLine(el1, el2, el3) {
      const s1 = getSymbolText(el1);
      const s2 = getSymbolText(el2);
      const s3 = getSymbolText(el3);

      const distinctNonWild = new Set(
        [s1, s2, s3].filter(sym => sym !== 'JOKER')
      );

      if (distinctNonWild.size <= 1) {
        // z√°klad 2√ó st√°vka
        let rowMultiplier = 2;
        // Ka≈æd√Ω "JOKER" nav√Ω≈°i √ó2
        const jokers = [s1, s2, s3].filter(x => x === 'JOKER').length;
        rowMultiplier *= Math.pow(2, jokers);

        el1.classList.add('highlight');
        el2.classList.add('highlight');
        el3.classList.add('highlight');
        return rowMultiplier;
      }
      return 0;
    }

    function getSymbolText(el) {
      const span = el.querySelector('.wildSymbol');
      if (span) return 'JOKER';
      return el.textContent.trim();
    }

    function removeAllHighlights() {
      reels.forEach((reel) => {
        reel.querySelectorAll('.symbol').forEach(sym => {
          sym.classList.remove('highlight');
        });
      });
    }

    function increaseBet() {
      betAmount += 10;
      updateDisplays();
    }

    function decreaseBet() {
      if (betAmount > 10) {
        betAmount -= 10;
        updateDisplays();
      }
    }

    /* Aktualizuje texty o kredite a st√°vke */
    function updateDisplays() {
      creditsBox.textContent = `Kredit: ${credits}`;
      // resultBox je len stav, ponech√°me ho
    }

    /* Tlaƒçidlo AUTO ako prep√≠naƒç */
    function toggleAutospin() {
      autoSpin = !autoSpin;
      const autoBtn = document.getElementById('autoBtn');
      if (autoSpin) {
        autoBtn.classList.add('active');
        // Ak m√°me dos≈• kreditov, rovno spust√≠me spin
        if (credits >= betAmount) spin();
        else {
          autoSpin = false;
          autoBtn.classList.remove('active');
        }
      } else {
        autoBtn.classList.remove('active');
      }
    }
  </script>
</body>
</html>
